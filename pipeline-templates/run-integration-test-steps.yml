parameters:
  testName: ''
  workingDirectory: ''
  strykerCommands: '--dev-mode'

steps:
  - task: UseDotNet@2
    displayName: 'Install dotnet core 3.0.x sdk for integrationtest'
    inputs:
      version: 3.0.x

  - script: dotnet-stryker ${{ parameters.strykerCommands }} -f -l trace
    workingDirectory: ${{ parameters.workingDirectory }}
    displayName: 'Run integration test ${{ parameters.testName }}'
    failOnStderr: false

  - task: PublishPipelineArtifact@0
    inputs:
      artifactName: ${{ parameters.testName }}
      targetPath: '${{ parameters.workingDirectory }}/StrykerOutput'
    condition: always()
    continueOnError: true